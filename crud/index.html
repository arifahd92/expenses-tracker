<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <title>Document</title>
  </head>
  <body>
    <form action="#">
      <input type="text" id="name" />
      <input type="email" name="" id="email" />
      <input type="number" name="number" id="number" />
      <input type="submit" name="" id="submit" />
    </form>
    <ul id="list"></ul>
    <script>
      let inp = document.querySelectorAll("input");
      let list = document.querySelector("#list");
      let obj = {
        name: "",
        email: "",
        phone: 0,
      };
      var alldata = [];
      submit.addEventListener("click", (e) => {
        e.preventDefault();
        console.log(inp[0].value);
        obj.name = inp[0].value;
        obj.email = inp[1].value;
        obj.phone = inp[2].value;
        // console.log(obj);
        if (obj.name && obj.email && obj.phone) {
          axios
            .post(
              "https://crudcrud.com/api/ac5f824e11294f51b67c58b9310e1096/appointment",
              obj
            )
            .then(function (response) {
              // Handle successful response
              console.log(response.data);
            })
            .catch(function (error) {
              // Handle error
              console.error(error);
            });

          inp[0].value = "";
          inp[1].value = "";
          inp[2].value = "";
          showAppointment();
        } else {
          showAppointment();
          alert("fill all the details ");
        }
        function showAppointment() {
          console.log("showappointmemt got called");
          axios
            .get(
              "https://crudcrud.com/api/ac5f824e11294f51b67c58b9310e1096/appointment"
            )
            .then((response) => {
              return response.data; // Extract the response data
            })
            .then((data) => {
              // console.log(data); // Log the extracted data
              alldata = data;
              console.log(alldata);
              alldata.forEach((data, ind) => {
                console.log("foreachmethod got called");
                let li = document.createElement("li");
                console.log(data.phone);
                li.innerText = `name:${data.name}- email:${data.email}-phone${data.phone}`;
                list.appendChild(li);
                let btn1 = document.createElement("button");
                btn1.id = "edit";
                btn1.innerText = "edit";
                let btn2 = document.createElement("button");
                btn2.id = "delete";
                btn2.innerText = "delete";
                li.appendChild(btn1);
                li.append(btn2);
              });
            })
            .catch((err) => {
              console.log(err); // Log any errors
            });
        }
      });
    </script>
  </body>
</html>
